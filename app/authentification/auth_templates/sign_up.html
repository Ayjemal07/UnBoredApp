{% extends 'base.html' %}

{% block content %}
<main class="form-container p-5">
    <div class="form-row">
        <div class="col-13 mx-auto">
            <div class="form-card shadow-sm p-4 mb-4">

                <h2>Create Your Account</h2>
                <form id="signupForm" method="POST" action="{{ url_for('auth.signup') }}">
                    <div id="step1">
                        <div class="form-group">
                            <label for="email">Email:</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Password:</label>
                            <input type="password" class="form-control" id="password" name="password" required>
                        </div>
                        <button type="button" class="btn btn-primary" onclick="validateStep(1)">Next</button>
                    </div>

                    <div id="step2" class="d-none">
                        <div class="form-group">
                            <label for="name">Name:</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="age">Age:</label>
                            <input type="number" class="form-control" id="age" name="age" required>
                        </div>
                        <div class="form-group">
                            <label for="location">Location:</label>
                            <input type="text" class="form-control" id="location" name="location" required>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="showStep(1)">Previous</button>
                        <button type="button" class="btn btn-primary" onclick="validateStep(2)">Next</button>
                    </div>

                    <div id="step3" class="d-none">
                        <div class="form-group">
                            <label for="interests">What are your interests? (Select all that apply)</label><br>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="arts" name="interests" value="Arts">
                                <label class="form-check-label" for="arts">Arts</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="sports" name="interests" value="Sports">
                                <label class="form-check-label" for="sports">Sports</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="nature" name="interests" value="Nature">
                                <label class="form-check-label" for="nature">Nature</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="music" name="interests" value="Music">
                                <label class="form-check-label" for="music">Music</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="technology" name="interests" value="Technology">
                                <label class="form-check-label" for="technology">Technology</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="reading" name="interests" value="Reading">
                                <label class="form-check-label" for="reading">Reading</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="travel" name="interests" value="Travel">
                                <label class="form-check-label" for="travel">Travel</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="cooking" name="interests" value="Cooking">
                                <label class="form-check-label" for="cooking">Cooking</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="gaming" name="interests" value="Gaming">
                                <label class="form-check-label" for="gaming">Gaming</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="activityTypes">What types of activities do you prefer? (Select all that apply)</label><br>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="outdoor" name="activityTypes" value="Outdoor">
                                <label class="form-check-label" for="outdoor">Outdoor</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="indoor" name="activityTypes" value="Indoor">
                                <label class="form-check-label" for="indoor">Indoor</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="solo" name="activityTypes" value="Solo">
                                <label class="form-check-label" for="solo">Solo</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="group" name="activityTypes" value="Group">
                                <label class="form-check-label" for="group">Group</label>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="showStep(2)">Previous</button>
                        <button type="button" class="btn btn-primary" onclick="validateStep(3)">Next</button>
                    </div>

                    <div id="step4" class="d-none">
                        <div class="form-group">
                            <label for="physicalLevel">What physical levels of activity do you prefer? (Select all that apply)</label><br>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="lowImpact" name="physicalLevel" value="Low impact">
                                <label class="form-check-label" for="lowImpact">Low impact</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="moderateImpact" name="physicalLevel" value="Moderate impact">
                                <label class="form-check-label" for="moderateImpact">Moderate impact</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="highEnergy" name="physicalLevel" value="High energy">
                                <label class="form-check-label" for="highEnergy">High energy</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="limitations">Do you have any physical limitations or preferences? (Select one)</label><br>
                            <div class="form-check">
                                <input type="radio" class="form-check-input" name="limitations" id="noDisability" value="No disability">
                                <label class="form-check-label" for="noDisability">No disability</label>
                            </div>
                            <div class="form-check">
                                <input type="radio" class="form-check-input" name="limitations" id="hearingImpairment" value="Hearing impairment">
                                <label class="form-check-label" for="hearingImpairment">Hearing impairment</label>
                            </div>
                            <div class="form-check">
                                <input type="radio" class="form-check-input" name="limitations" id="visualImpairment" value="Visual impairment">
                                <label class="form-check-label" for="visualImpairment">Visual impairment</label>
                            </div>
                            <div class="form-check">
                                <input type="radio" class="form-check-input" name="limitations" id="mobilityIssues" value="Mobility issues">
                                <label class="form-check-label" for="mobilityIssues">Mobility issues (trouble walking/standing)</label>
                            </div>
                            <div class="form-check">
                                <input type="radio" class="form-check-input" name="limitations" id="otherLimitations" value="Other limitations" onclick="toggleOtherField()">
                                <label class="form-check-label" for="otherLimitations">Other (please specify)</label>
                            </div>
                            <input type="text" id="limitationsOther" name="limitationsOther" class="form-control d-none" placeholder="Please specify">
                        </div>
                        <div class="form-group">
                            <label for="budget">What is your budget for activities? (Select all that apply)</label><br>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="free" name="budget" value="Free">
                                <label class="form-check-label" for="free">Free</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="lowCost" name="budget" value="Low cost">
                                <label class="form-check-label" for="lowCost">Low cost</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="willingToInvest" name="budget" value="Willing to invest">
                                <label class="form-check-label" for="willingToInvest">Willing to invest</label>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="showStep(3)">Previous</button>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</main>

<script>
    function showStep(stepNumber) {
        // Hide all steps
        for (let i = 1; i <= 4; i++) {
            document.getElementById('step' + i).classList.add('d-none');
        }
        // Show the selected step
        document.getElementById('step' + stepNumber).classList.remove('d-none');
    }

    function validateStep(stepNumber) {
        let isValid = false;
        if (stepNumber === 1) {
            // Validate email and password
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            if (email && password) {
                isValid = true;
            } else {
                alert('Please fill out the email and password fields.');
            }
        } else if (stepNumber === 2) {
            // Validate that at least one field is filled in Step 2
            const name = document.getElementById('name').value;
            const age = document.getElementById('age').value;
            const location = document.getElementById('location').value;
            if (name && age && location) {
                isValid = true;
            } else {
                alert('Please fill out all fields in this step.');
            }
        } else if (stepNumber === 3) {
            // Validate that at least one checkbox is checked in Step 3
            const interests = document.querySelectorAll('input[name="interests"]:checked').length > 0;
            const activityTypes = document.querySelectorAll('input[name="activityTypes"]:checked').length > 0;
            if (interests || activityTypes) {
                isValid = true;
            } else {
                alert('Please select at least one interest or activity type.');
            }
        } else if (stepNumber === 4) {
            // Validate that at least one checkbox is checked in Step 4
            const physicalLevels = document.querySelectorAll('input[name="physicalLevel"]:checked').length > 0;
            const limitations = document.querySelectorAll('input[name="limitations"]:checked').length > 0;
            const budget = document.querySelectorAll('input[name="budget"]:checked').length > 0;
            if (physicalLevels || limitations || budget) {
                isValid = true;
            } else {
                alert('Please select at least one physical level, limitation, or budget.');
            }
        }

        if (isValid) {
            showStep(stepNumber + 1);
        }
    }

    function toggleOtherField() {
        const otherLimitationsField = document.getElementById('limitationsOther');
        if (document.getElementById('otherLimitations').checked) {
            otherLimitationsField.classList.remove('d-none');
        } else {
            otherLimitationsField.classList.add('d-none');
        }
    }

    document.getElementById('signupForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const formData = new FormData(this);

        fetch(this.action, {
            method: 'POST',
            body: formData
        }).then(response => {
            if (response.ok) {
                window.location.href = response.url;
            } else {
                return response.text().then(text => {
                    alert('Error submitting form: ' + text);
                });
            }
        }).catch(error => {
            console.error('Error:', error);
            alert('Network error. Please try again later.');
        });
    });
    
    
</script>

{% endblock %}
